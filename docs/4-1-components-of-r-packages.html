<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="4.1 Components of R packages | R for Environmental Health Research" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Online booklet for workshop on R for environmental health research, geared to those who already use R for their research but want to learn more tools." />
<meta name="github-repo" content="rstudio/bookdown-demo" />

<meta name="author" content="Brooke Anderson" />

<meta name="date" content="2019-04-09" />


<meta name="description" content="Online booklet for workshop on R for environmental health research, geared to those who already use R for their research but want to learn more tools.">

<title>4.1 Components of R packages | R for Environmental Health Research</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#prerequisites"><span class="toc-section-number">1</span> Prerequisites</a><ul>
<li><a href="1-1-set-up.html#set-up"><span class="toc-section-number">1.1</span> Set-up</a></li>
</ul></li>
<li class="has-sub"><a href="2-organize.html#organize"><span class="toc-section-number">2</span> Organize</a><ul>
<li><a href="2-1-r-projects.html#r-projects"><span class="toc-section-number">2.1</span> R Projects</a></li>
<li class="has-sub"><a href="2-2-directory-organization.html#directory-organization"><span class="toc-section-number">2.2</span> Directory organization</a><ul>
<li><a href="2-2-directory-organization.html#keeping-things-tidy"><span class="toc-section-number">2.2.1</span> Keeping things tidy</a></li>
<li><a href="2-2-directory-organization.html#avoiding-repetition"><span class="toc-section-number">2.2.2</span> Avoiding repetition</a></li>
</ul></li>
<li><a href="2-3-learn-more.html#learn-more"><span class="toc-section-number">2.3</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="3-track.html#track"><span class="toc-section-number">3</span> Track</a><ul>
<li class="has-sub"><a href="3-1-git.html#git"><span class="toc-section-number">3.1</span> git</a><ul>
<li><a href="3-1-git.html#configuring-git"><span class="toc-section-number">3.1.1</span> Configuring git</a></li>
<li><a href="3-1-git.html#tracking-an-r-project"><span class="toc-section-number">3.1.2</span> Tracking an R project</a></li>
</ul></li>
<li><a href="3-2-github.html#github"><span class="toc-section-number">3.2</span> GitHub</a></li>
<li><a href="3-3-terminal.html#terminal"><span class="toc-section-number">3.3</span> Terminal</a></li>
<li class="has-sub"><a href="3-4-try-it-out.html#try-it-out"><span class="toc-section-number">3.4</span> Try it out</a><ul>
<li><a href="3-4-try-it-out.html#track-a-project-with-git"><span class="toc-section-number">3.4.1</span> Track a project with git</a></li>
<li><a href="3-4-try-it-out.html#link-the-project-with-a-github-repository"><span class="toc-section-number">3.4.2</span> Link the project with a GitHub repository</a></li>
</ul></li>
<li><a href="3-5-learn-more-1.html#learn-more-1"><span class="toc-section-number">3.5</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="4-package.html#package"><span class="toc-section-number">4</span> Package</a><ul>
<li class="has-sub"><a href="4-1-components-of-r-packages.html#components-of-r-packages"><span class="toc-section-number">4.1</span> Components of R packages</a><ul>
<li><a href="4-1-components-of-r-packages.html#r-code"><span class="toc-section-number">4.1.1</span> R code</a></li>
<li><a href="4-1-components-of-r-packages.html#description-file"><span class="toc-section-number">4.1.2</span> DESCRIPTION file</a></li>
<li><a href="4-1-components-of-r-packages.html#other-package-components"><span class="toc-section-number">4.1.3</span> Other package components</a></li>
</ul></li>
<li><a href="4-2-try-it-out-1.html#try-it-out-1"><span class="toc-section-number">4.2</span> Try it out</a></li>
<li class="has-sub"><a href="4-3-sharing.html#sharing"><span class="toc-section-number">4.3</span> Sharing</a><ul>
<li><a href="4-3-sharing.html#when-to-publish-your-packages"><span class="toc-section-number">4.3.1</span> When to publish your packages</a></li>
<li><a href="4-3-sharing.html#where-to-publish-packages"><span class="toc-section-number">4.3.2</span> Where to publish packages</a></li>
<li><a href="4-3-sharing.html#extra-steps-for-publishing"><span class="toc-section-number">4.3.3</span> Extra steps for publishing</a></li>
</ul></li>
<li><a href="4-4-learn-more-2.html#learn-more-2"><span class="toc-section-number">4.4</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="5-collect.html#collect"><span class="toc-section-number">5</span> Collect</a><ul>
<li class="has-sub"><a href="5-1-open-data.html#open-data"><span class="toc-section-number">5.1</span> Open data</a><ul>
<li><a href="5-1-open-data.html#admin-databases"><span class="toc-section-number">5.1.1</span> [Admin databases?]</a></li>
<li><a href="5-1-open-data.html#research-repositories"><span class="toc-section-number">5.1.2</span> [Research repositories?]</a></li>
</ul></li>
<li><a href="5-2-data-packages.html#data-packages"><span class="toc-section-number">5.2</span> Data packages</a></li>
<li><a href="5-3-web-services.html#web-services"><span class="toc-section-number">5.3</span> Web services [?]</a></li>
<li><a href="5-4-ropensci.html#ropensci"><span class="toc-section-number">5.4</span> ROpenSci</a></li>
<li><a href="5-5-learn-more-3.html#learn-more-3"><span class="toc-section-number">5.5</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="6-process.html#process"><span class="toc-section-number">6</span> Process</a><ul>
<li><a href="6-1-learn-more-4.html#learn-more-4"><span class="toc-section-number">6.1</span> Learn more</a></li>
</ul></li>
<li><a href="7-final-words.html#final-words"><span class="toc-section-number">7</span> Final Words</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="components-of-r-packages" class="section level2">
<h2><span class="header-section-number">4.1</span> Components of R packages</h2>
<div id="r-code" class="section level3">
<h3><span class="header-section-number">4.1.1</span> R code</h3>
<p>Without R code, there’s not much point to an R package.<label for="tufte-sn-11" class="margin-toggle sidenote-number">11</label><input type="checkbox" id="tufte-sn-11" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">11</span> The exception? A data-only package,
where the package’s purpose is to share data rather than R functions. We’ll look at an
example in the “Collect” section.</span> The R function code will go in the package’s “R”
subdirectory. You can use as many or as few “.R” files in this section as you want to
organize your code.
Define your functions in this section as you would if you were creating functions in
an R script. As you become more advanced in writing packages, you may want to start
adapting your function code a bit. For example, the <code>package::function</code> notation can
help keep clear which package you mean for a function to call a function from, and so
the behavior will be stable regardless of the order that a user loaded packages.
Also, if you intend for your functions to be used inside tidyverse pipelines, you’ll
want to take a look at the developing <a href="https://tidyeval.tidyverse.org/">Tidy evaluation</a> book.</p>
<p>Although it is not required for a package you’re creating just to use yourself, you
should think about adding help documentation to your code very early. You can then
access this documentation through helpfiles in R, just like you do with other R packages.
Even if you are just creating a package for yourself, you should add documentation
for all the “top-level” functions<label for="tufte-sn-12" class="margin-toggle sidenote-number">12</label><input type="checkbox" id="tufte-sn-12" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">12</span> <strong>top-level functions.</strong> The functions in your package
that you expect your users (including yourself) to call directly. Your package may also
include some functions that are “helpers”, only used within other functions to help
keep the code clean and avoid replication, but never used directly by package users.</span></p>
<p>Years ago, you would need to write this documentation in separate “.Rd” files
and save them in the “man” subdirectory. Now, the easiest thing to do is to use
“roxygen” conventions to write the help information right above each function.
With this style, you’ll use a special type of commenting character (<code>#'</code>) at the
start of each line with documentation, and there are special codes (e.s.,
<code>@param</code> when you’re defining one of the function’s parameters) to annotate this
code. This help documentation will then, when you build your package, be
converted to the “.Rd” files you used to have to write yourself and saved in the
“man” directory. Several of the resources listed in “Learn more” give more
details on writing and rendering this help documentation.</p>
</div>
<div id="description-file" class="section level3">
<h3><span class="header-section-number">4.1.2</span> DESCRIPTION file</h3>
<p>Every package directory must have a DESCRIPTION file, but if you aren’t sharing
the package, there’s no harm in leaving this as the original template file you
get when you start a package directory using RStudio (you’ll try this out in
just a minute). The exception is when your functions rely on functions from
other R packages—in this case, you’ll want to add in these dependencies in the
DESCRIPTION file. That way, when you load your package, all of these will also
be loaded.</p>
<p>If you plan to share your package with others, however, and especially if you
plan to publish your package in CRAN or another repository, you’ll need to do
a lot more with the DESCRIPTION file. This file provides the metadata on your package,
including the authors, version, description, and dependencies on other packages.
The <strong>R Packages</strong> book referenced in the “Learn More” section has extensive advice
on editing this file for packages meant for publication.</p>
</div>
<div id="other-package-components" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Other package components</h3>
<p>So far, I’ve described the barebones elements you’ll need to have to create a very
minimalist package. There are, however, a number of other elements you’ll often
want to add to the package. As with the R code for package functions and the
DESCRIPTION file, there is a specific location and format required for each of
these elements within an R package.</p>
<p>Some of the most common components you’ll want to add include example datasets
(which will go in a <code>data</code> subdirectory), tutorials for using the package
(<code>vignettes</code> subdirectory), and unit tests for the functions (<code>tests</code>
subdirectory). To help you set up these extra components, you may want to take a
look at the <code>use_*</code> family of functions in the <code>usethis</code> <span class="citation">(Wickham and Bryan <label for="tufte-mn-3" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-3" class="margin-toggle">2018<span class="marginnote">Wickham, Hadley, and Jennifer Bryan. 2018. <em>Usethis: Automate Package and Project Setup</em>. <a href="https://CRAN.R-project.org/package=usethis">https://CRAN.R-project.org/package=usethis</a>.</span>)</span>
package<label for="tufte-sn-13" class="margin-toggle sidenote-number">13</label><input type="checkbox" id="tufte-sn-13" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">13</span> The <code>use_*</code> family of functions were previously in the <code>devtools</code>
package, but they are being deprecated there and moved to the <code>usethis</code> package.
The <a href="http://r-pkgs.had.co.nz/">R Packages</a> book was written before they were
deprecated in <code>devtools</code>, and so it discusses them as <code>devtools</code> functions. As
long as you install and load the <code>usethis</code> package, though, you’ll have no
problem following along with the examples in that book.</span> For example, if you
want to include example data in your package, you should check out the
<code>use_data</code> function, while if you want to add unit tests to your package, check
out the <code>use_test</code> function. When you run one of these, you’ll notice that the
function <em>adds files and subdirectories</em> when needed to your R package
directory. This may throw you at first, since most R functions don’t make
changes to your file directory, but you’ll need those added files to add the
package components, and it’s <em>much</em> easier to remember a single function call to
run when you need to add one than to remember all the details of which files (and
in what structure) need to be added.</p>
</div>
</div>
<p style="text-align: center;">
<a href="4-package.html"><button class="btn btn-default">Previous</button></a>
<a href="4-2-try-it-out-1.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
