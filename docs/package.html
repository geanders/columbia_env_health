<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 4 Package | R for Environmental Health Research</title>
  <meta name="description" content="Online booklet for workshop on R for environmental health research, geared to those who already use R for their research but want to learn more tools.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 4 Package | R for Environmental Health Research" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Online booklet for workshop on R for environmental health research, geared to those who already use R for their research but want to learn more tools." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Package | R for Environmental Health Research" />
  
  <meta name="twitter:description" content="Online booklet for workshop on R for environmental health research, geared to those who already use R for their research but want to learn more tools." />
  

<meta name="author" content="Brooke Anderson">


<meta name="date" content="2019-04-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="track.html">
<link rel="next" href="collect.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.0.1</b> Overview</a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#set-up"><i class="fa fa-check"></i><b>1.0.2</b> Set-up</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="organize.html"><a href="organize.html"><i class="fa fa-check"></i><b>2</b> Organize</a><ul>
<li class="chapter" data-level="2.1" data-path="organize.html"><a href="organize.html#r-projects"><i class="fa fa-check"></i><b>2.1</b> R Projects</a></li>
<li class="chapter" data-level="2.2" data-path="organize.html"><a href="organize.html#directory-organization"><i class="fa fa-check"></i><b>2.2</b> Directory organization</a><ul>
<li class="chapter" data-level="2.2.1" data-path="organize.html"><a href="organize.html#keeping-things-tidy"><i class="fa fa-check"></i><b>2.2.1</b> Keeping things tidy</a></li>
<li class="chapter" data-level="2.2.2" data-path="organize.html"><a href="organize.html#avoiding-repetition"><i class="fa fa-check"></i><b>2.2.2</b> Avoiding repetition</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="organize.html"><a href="organize.html#learn-more"><i class="fa fa-check"></i><b>2.3</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="track.html"><a href="track.html"><i class="fa fa-check"></i><b>3</b> Track</a><ul>
<li class="chapter" data-level="3.1" data-path="track.html"><a href="track.html#git"><i class="fa fa-check"></i><b>3.1</b> git</a></li>
<li class="chapter" data-level="3.2" data-path="track.html"><a href="track.html#github"><i class="fa fa-check"></i><b>3.2</b> GitHub</a></li>
<li class="chapter" data-level="3.3" data-path="track.html"><a href="track.html#terminal"><i class="fa fa-check"></i><b>3.3</b> Terminal</a><ul>
<li class="chapter" data-level="3.3.1" data-path="track.html"><a href="track.html#accessing-a-bash-shell"><i class="fa fa-check"></i><b>3.3.1</b> Accessing a Bash Shell</a></li>
<li class="chapter" data-level="3.3.2" data-path="track.html"><a href="track.html#git2r-package"><i class="fa fa-check"></i><b>3.3.2</b> <code>git2r</code> package</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="track.html"><a href="track.html#learn-more-1"><i class="fa fa-check"></i><b>3.4</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="package.html"><a href="package.html"><i class="fa fa-check"></i><b>4</b> Package</a><ul>
<li class="chapter" data-level="4.1" data-path="package.html"><a href="package.html#r-packages"><i class="fa fa-check"></i><b>4.1</b> R packages</a><ul>
<li class="chapter" data-level="4.1.1" data-path="package.html"><a href="package.html#r-code"><i class="fa fa-check"></i><b>4.1.1</b> R code</a></li>
<li class="chapter" data-level="4.1.2" data-path="package.html"><a href="package.html#description-file"><i class="fa fa-check"></i><b>4.1.2</b> DESCRIPTION file</a></li>
<li class="chapter" data-level="4.1.3" data-path="package.html"><a href="package.html#other-package-components"><i class="fa fa-check"></i><b>4.1.3</b> Other package components</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="package.html"><a href="package.html#publishing"><i class="fa fa-check"></i><b>4.2</b> Publishing</a><ul>
<li class="chapter" data-level="4.2.1" data-path="package.html"><a href="package.html#why-publish-your-packages"><i class="fa fa-check"></i><b>4.2.1</b> Why publish your packages?</a></li>
<li class="chapter" data-level="4.2.2" data-path="package.html"><a href="package.html#where-to-publish-packages"><i class="fa fa-check"></i><b>4.2.2</b> Where to publish packages</a></li>
<li class="chapter" data-level="4.2.3" data-path="package.html"><a href="package.html#extra-steps-for-publishing"><i class="fa fa-check"></i><b>4.2.3</b> Extra steps for publishing</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="package.html"><a href="package.html#checking"><i class="fa fa-check"></i><b>4.3</b> Checking</a></li>
<li class="chapter" data-level="4.4" data-path="package.html"><a href="package.html#try-it-out"><i class="fa fa-check"></i><b>4.4</b> Try it out</a></li>
<li class="chapter" data-level="4.5" data-path="package.html"><a href="package.html#learn-more-2"><i class="fa fa-check"></i><b>4.5</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="collect.html"><a href="collect.html"><i class="fa fa-check"></i><b>5</b> Collect</a><ul>
<li class="chapter" data-level="5.1" data-path="collect.html"><a href="collect.html#open-data"><i class="fa fa-check"></i><b>5.1</b> Open data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="collect.html"><a href="collect.html#admin-databases"><i class="fa fa-check"></i><b>5.1.1</b> [Admin databases?]</a></li>
<li class="chapter" data-level="5.1.2" data-path="collect.html"><a href="collect.html#research-repositories"><i class="fa fa-check"></i><b>5.1.2</b> [Research repositories?]</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="collect.html"><a href="collect.html#web-services"><i class="fa fa-check"></i><b>5.2</b> Web services [?]</a></li>
<li class="chapter" data-level="5.3" data-path="collect.html"><a href="collect.html#ropensci"><i class="fa fa-check"></i><b>5.3</b> ROpenSci</a></li>
<li class="chapter" data-level="5.4" data-path="collect.html"><a href="collect.html#learn-more-3"><i class="fa fa-check"></i><b>5.4</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="process.html"><a href="process.html"><i class="fa fa-check"></i><b>6</b> Process</a><ul>
<li class="chapter" data-level="6.1" data-path="process.html"><a href="process.html#learn-more-4"><i class="fa fa-check"></i><b>6.1</b> Learn more</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>7</b> Final Words</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Environmental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="package" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Package</h1>
<p><span class="newthought">As with many other things in R,</span> the threshold of complexity
for writing your own package has recently lowered dramatically. If you are writing
some of your own functions in R to use for your research, and you’ve become comfortable
with writing functions, you should try putting them in an R package. You don’t have
to share this package through publishing it on CRAN or another repository—instead, it’s
fine to start by just writing packages for your own use, or for your research group’s
private use. However, once you start writing packages, you will see how straightforward
it is, and you may want to take the extra steps to prepare your package for CRAN and
submit it.</p>
<div id="r-packages" class="section level2">
<h2><span class="header-section-number">4.1</span> R packages</h2>
<div id="r-code" class="section level3">
<h3><span class="header-section-number">4.1.1</span> R code</h3>
<p>[Where to put it]</p>
<p>[How to add documentation]</p>
</div>
<div id="description-file" class="section level3">
<h3><span class="header-section-number">4.1.2</span> DESCRIPTION file</h3>
<ul>
<li>License</li>
</ul>
</div>
<div id="other-package-components" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Other package components</h3>
<p>So far, I’ve described the barebones elements you’ll need to have to create a very
minimalist package. There are, however, a number of other elements you’ll often
want to add to the package. As with the R code for package functions and the
DESCRIPTION file, there is a specific location and format required for each of
these elements within an R package.</p>
<p>Some of the most common components you’ll want to add are:</p>
<ul>
<li><strong>Example data.</strong></li>
<li><strong>Vignettes.</strong></li>
<li><strong>Unit tests.</strong></li>
</ul>
<p>To help you set up these extra components,
you may want to take a look at the <code>use_*</code> family of functions in the <code>usethis</code>
<span class="citation">(Wickham and Bryan <a href="#ref-R-usethis">2018</a>)</span>
package<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> For example, if you want to include example data in your package,
you should check out the <code>use_data</code> function, while if you want to add unit tests to your
package, check out the <code>use_test</code> function. When you run one of these, you’ll notice that the
function <em>adds files and subdirectories</em> when needed to your R package directory. This may
throw you at first, since most R functions don’t make changes to your file directory, but
you’ll need those added files to add the package components, and it’s <em>much</em> easier to
remember a single function call to run when you need to add one than to remember all the
details of which files and in what structure need to be added.</p>
</div>
</div>
<div id="publishing" class="section level2">
<h2><span class="header-section-number">4.2</span> Publishing</h2>
<div id="why-publish-your-packages" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Why publish your packages?</h3>
</div>
<div id="where-to-publish-packages" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Where to publish packages</h3>
</div>
<div id="extra-steps-for-publishing" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Extra steps for publishing</h3>
<p>If you want to submit your package to CRAN, you’ll need to take a few extra steps
to get it ready. These steps aren’t necessary for a package you plan to just
use privately, but they wouldn’t be a bad idea to try to do even in that case.</p>
<p>First, you’ll need to make sure that the functions in your package are
comprehensively documented. [What are requirements for this for CRAN?]</p>
<p>In addition to documenting specific functions, you should also consider
writing overall tutorials that walk a user through how to use your
package in a few example scenarios. <strong>vignette</strong><a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
<p>You will also need to make sure that your package can run on different
operating systems. If your package only has functions written exclusively
in R, and doesn’t interact with [the computer system?] or other programs
on your computer, this shouldn’t be an issue. However, you should still
check. [Travis CI, winbuilder]</p>
<p>[CRAN checks]</p>
</div>
</div>
<div id="checking" class="section level2">
<h2><span class="header-section-number">4.3</span> Checking</h2>
</div>
<div id="try-it-out" class="section level2">
<h2><span class="header-section-number">4.4</span> Try it out</h2>
<ul>
<li>Create a new R Project for an R package</li>
<li>Move a function into the right place in the package</li>
<li>Edit the DESCRIPTION file as needed</li>
<li>Build the package</li>
<li>Add example data into the right place in the package</li>
<li>Add some unit tests for the function</li>
<li>Add documentation using roxygen2 notation</li>
<li>Add a short vignette</li>
</ul>
</div>
<div id="learn-more-2" class="section level2">
<h2><span class="header-section-number">4.5</span> Learn more</h2>
<p>One wonderful resource for writing and publishing R packages is the book <a href="http://r-pkgs.had.co.nz/">R
Packages</a> by Hadley Wickham. This book is available
for a reasonable price in paperback (many Barnes &amp; Nobles carry it in their
computer section) and is also available for free online. The author of this book
also created and maintains the <strong><code>devtools</code> package</strong><a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<ul>
<li>ROpenSci handbook</li>
<li>Official R documentation</li>
<li>Coursera, Leanpub</li>
</ul>

</div>
</div>
<h3> Final Words</h3>
<div id="refs" class="references">
<div id="ref-R-usethis">
<p>Wickham, Hadley, and Jennifer Bryan. 2018. <em>Usethis: Automate Package and Project Setup</em>. <a href="https://CRAN.R-project.org/package=usethis">https://CRAN.R-project.org/package=usethis</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="12">
<li id="fn12"><p>The <code>use_*</code> family of functions were previously in the <code>devtools</code> package, but they
are being deprecated there and moved to the <code>usethis</code>
package. The <a href="http://r-pkgs.had.co.nz/">R Packages</a> book was written before they were deprecated
in <code>devtools</code>, and so it discusses them as <code>devtools</code> functions. As long as you install and load
the <code>usethis</code> package, though, you’ll have no problem following along with the examples in
that book.<a href="package.html#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p><strong>vignette.</strong> …<a href="package.html#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p><strong><code>devtools</code> package.</strong>
An R package with functions that facilitate R package development. These
functions are well-documented in the package documentation as well as through
the book <a href="http://r-pkgs.had.co.nz/">R Packages</a>. This package also includes a
function for installing R packages from code posted on GitHub
(<code>install_github</code>), which is very useful if you want to find and use packages
that are not yet available on CRAN and other repositories or if you want to use
the latest, “development” version of a package. This package is available on
CRAN and so can be installed with <code>install.packages("devtools")</code>.<a href="package.html#fnref14" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="track.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="collect.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-package.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["columbia_env_health.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
